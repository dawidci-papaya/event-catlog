import{j as e}from"./jsx-runtime.B8R7zBj2.js";import{r as i}from"./index.GM20xmA1.js";import{a as m,b as P}from"./url-builder.CA2d8hgU.js";import{a as j,S as C,T as R,P as v,g as N}from"./components.Tgsd0fYW.js";import{F as b,a as p}from"./ServerIcon.CXB7VS2s.js";import"./_commonjsHelpers.D6-XlEtG.js";function A({services:g,embeded:y}){const[x,w]=i.useState(""),[c,u]=i.useState(1),[r,I]=i.useState([]),o=16,[t,S]=i.useState(null);i.useEffect(()=>{const a=new URLSearchParams(window.location.search),s=a.get("serviceIds")?.split(",").filter(Boolean),n=a.get("domainId")||void 0,l=a.get("domainName")||void 0,h=a.get("serviceName")||void 0;S({serviceIds:s,domainId:n,domainName:l,serviceName:h})},[]);const d=i.useMemo(()=>{if(t===null)return[];let a=[...g];if(t.serviceIds?.length&&(a=a.filter(s=>t.serviceIds?.includes(s.data.id)&&!s.data.id.includes("/versioned/"))),x){const s=x.toLowerCase();a=a.filter(n=>n.data.name?.toLowerCase().includes(s)||n.data.summary?.toLowerCase().includes(s)||n.data.sends?.some(l=>l.data.name.toLowerCase().includes(s))||n.data.receives?.some(l=>l.data.name.toLowerCase().includes(s)))}return r.length>0&&(a=a.filter(s=>{const n=s.data.sends?.some(h=>r.includes(h.collection)),l=s.data.receives?.some(h=>r.includes(h.collection));return n||l})),a.sort((s,n)=>(s.data.name||s.data.id).localeCompare(n.data.name||n.data.id)),a},[g,x,t,r]),$=i.useMemo(()=>{if(t?.domainId||t?.serviceIds?.length)return d;const a=(c-1)*o;return d.slice(a,a+o)},[d,c,t]),f=i.useMemo(()=>t?.domainId||t?.serviceIds?.length?1:Math.ceil(d.length/o),[d.length,t]);return i.useEffect(()=>{u(1)},[x,r]),e.jsxs("div",{children:[e.jsxs("nav",{className:"mb-4 flex items-center space-x-2 text-sm text-gray-500",children:[e.jsxs("a",{href:m("/architecture/domains"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"Domains"]}),e.jsx(j,{className:"h-4 w-4"}),e.jsxs("a",{href:m("/architecture/services"),className:"hover:text-gray-700 hover:underline flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),"Services"]}),t?.domainId&&e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4"}),e.jsx("span",{className:"text-gray-900",children:t.domainId})]})]}),e.jsx("div",{className:"relative border-b border-gray-200 mb-4 pb-4",children:e.jsxs("div",{className:"md:flex md:items-start md:justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1 max-w-lg",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h1",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:t?.domainId?`${t.domainName} Architecture`:"All Services"})}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:t?.domainId?`Browse services and messages in the ${t.domainId} domain`:"Browse and discover services in your event-driven architecture"})]}),e.jsx("div",{className:"mt-6 md:mt-0 md:ml-4 flex-shrink-0",children:e.jsx(C,{searchQuery:x,onSearchChange:w,placeholder:"Search services by name, summary, or messages...",totalResults:d.length,totalItems:g.length})})]})}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsx(R,{selectedTypes:r,onTypeChange:I,filteredCount:d.length,totalCount:g.length}),e.jsx("div",{className:"text-sm text-gray-500",children:t?.domainId||t?.serviceIds?.length?e.jsxs("span",{children:["Showing ",d.length," services in the ",t.domainId," domain"]}):e.jsxs("span",{children:["Showing ",(c-1)*o+1," to"," ",Math.min(c*o,d.length)," of ",d.length," ","services"]})}),!(t?.domainId||t?.serviceIds?.length)&&e.jsx(v,{currentPage:c,totalPages:f,totalItems:d.length,itemsPerPage:o,onPageChange:u})]})}),d.length>0&&e.jsxs("div",{className:`rounded-xl overflow-hidden ${t?.domainId?"bg-yellow-50 p-8 border-2 border-yellow-400":""}`,children:[t?.domainName&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-5 w-5 text-yellow-500"}),e.jsx("span",{className:"text-2xl font-semibold text-gray-900",children:t.domainName})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("a",{href:m(`/visualiser/domains/${t.domainId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium bg-white border border-gray-300 rounded-md transition-colors duration-200",children:"View in visualizer"}),e.jsx("a",{href:m(`/docs/domains/${t.domainId}`),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-black border border-gray-300 bg-white  rounded-md transition-colors duration-200",children:"Read documentation"})]})]})}),e.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-1 lg:grid-cols-1 xl:grid-cols-${y?1:2} gap-6`,children:$.map(a=>e.jsx("a",{href:P("/architecture/messages",{serviceName:a.data.name,serviceId:a.data.id,domainId:t?.domainId,domainName:t?.domainName}),className:"group hover:bg-pink-50  bg-white border-2 border-dashed border-pink-400 rounded-lg shadow-sm hover:shadow-lg transition-all duration-200 overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx(p,{className:"h-5 w-5 text-pink-500"}),e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 truncate group-hover:underline transition-colors duration-200 w-full max-w-[90%]",children:[a.data.name||a.data.id," (v",a.data.version,")"]})]})}),a.data.summary&&e.jsx("p",{className:"text-gray-600 text-sm line-clamp-2 min-h-[2.5rem]",children:a.data.summary}),e.jsx("div",{className:"space-y-4",children:!t?.serviceName&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 h-full flex flex-col bg-blue-100 border border-blue-300 rounded-lg p-4",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[a.data.receives?.filter(s=>r.length===0||r.includes(s.collection))?.map(s=>{const{Icon:n,color:l}=N(s.collection);return e.jsxs("a",{href:m(`/docs/${s.collection}/${s.data.id}/${s.data.version}`),className:"group flex border border-gray-200 items-center gap-1 rounded-md text-[11px] font-medium hover:bg-gray-50 transition-colors duration-200 bg-white",children:[e.jsx("div",{className:"bg-white border-r border-gray-200 px-2 py-1.5 rounded-l-md",children:e.jsx(n,{className:`h-3 w-3 text-${l}-500`})}),e.jsx("span",{className:"px-1 py-1 truncate max-w-[140px]",children:s.data.name})]},s.data.name)}),(!a.data.receives?.length||r.length>0&&!a.data.receives?.some(s=>r.includes(s.collection)))&&e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 text-[10px]",children:r.length>0?`Service does not receive ${r.join(" or ")}`:"Service does not receive any messages"})})]})}),e.jsxs("div",{className:"flex items-center gap-2 max-w-[200px]",children:[e.jsx("div",{className:"w-4 h-[2px] bg-blue-200"}),e.jsx("div",{className:"bg-white border-2 border-pink-100 rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx(p,{className:"h-8 w-8 text-pink-500"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.data.name||a.data.id}),e.jsxs("p",{className:"text-xs text-gray-500",children:["v",a.data.version]})]})]})}),e.jsx("div",{className:"w-4 h-[2px] bg-emerald-200"})]}),e.jsx("div",{className:"flex-1 h-full flex flex-col bg-green-100 border border-green-300 rounded-lg p-4",children:e.jsxs("div",{className:"space-y-2 flex-1",children:[a.data.sends?.filter(s=>r.length===0||r.includes(s.collection))?.map(s=>{const{Icon:n,color:l}=N(s.collection);return e.jsxs("a",{href:m(`/docs/${s.collection}/${s.data.id}/${s.data.version}`),className:"group flex border border-gray-200 items-center gap-1 rounded-md text-[11px] font-medium hover:bg-gray-50 transition-colors duration-200 bg-white",children:[e.jsx("div",{className:"bg-white border-r border-gray-200 px-2 py-1.5 rounded-l-md",children:e.jsx(n,{className:`h-3 w-3 text-${l}-500`})}),e.jsx("span",{className:"px-1 py-1 truncate max-w-[140px]",children:s.data.name})]},s.data.name)}),(!a.data.sends?.length||r.length>0&&!a.data.sends?.some(s=>r.includes(s.collection)))&&e.jsx("div",{className:"text-center py-4  ",children:e.jsx("p",{className:"text-gray-500 text-[10px]",children:r.length>0?`Service does not send ${r.join(" or ")}`:"Service does not send any messages"})})]})})]})})]})},a.data.id))})]}),d.length===0&&e.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-500 text-lg",children:r.length>0?`No services found that ${r.length>1?"handle":"handles"} ${r.join(" or ")} messages`:"No services found matching your criteria"})}),!(t?.domainId||t?.serviceIds?.length)&&e.jsx("div",{className:"mt-8 border-t border-gray-200",children:e.jsx(v,{currentPage:c,totalPages:f,totalItems:d.length,itemsPerPage:o,onPageChange:u})})]})}export{A as default};
